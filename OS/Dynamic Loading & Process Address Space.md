# Dynamic Loading

Java 프로그램은 한 개 혹은 그 이상의 클래스들의 조합으로 실행된다. 그리고 실행 시 모든 클래스 파일들이 한 번에 JVM 메모리에 로딩되지 않고 요청되는 순간 로딩된다. Java의 **클래스 로더**가 이 역할을 수행한다. 여기서 클래스 로더는 '.class' 바이트 코드를 읽어 들여 class 객체를 생성하는 역할을 담당한다. 즉, 클래스 로더는 클래스가 요청될 때 파일로부터 읽어 메모리로 로딩하는 역할을 하며 JVM의 중요한 요소 중 하나이다.

자바의 클래스 로딩은 세부적으로 

메모리를 효율적으로 사용하기 위해 나온 방법이다. 프로세스가 시작될 때 해당 프로세스 전체를 메모리에 올리는게 아니라, 필요한 루틴(기능)이 호출될 때 해당 루틴만을 메모리에 적재하는 방식을 의미한다.

![img](https://t1.daumcdn.net/cfile/tistory/99CC283D5C57619618)

먼저 Loading은 저장소(하드디스크)에서 메모리로 데이터를 옮기는 작업이다. 프로그램을 실행시키면 .exe에 있는 파일이 메모리에 올라가야 실행이 되는데, 그것을 메모리에 적재한다 해서 로딩이라고 한다. 아래에서 더 자세하게 살펴보자.

### Process Address Space

메모리 주소에 저장된 프로세스 형태는 다음과 같다.

![img](https://t1.daumcdn.net/cfile/tistory/99CA543C5C57625C16)

 제일 아래 영역부터 Text Segment, Data Segment, Heap 으로 구성되어 있고, Stack은 위에서부터 밑으로 영역을 차지한다.

- **Text Segment & Data Segment**

  프로그래밍한 코드와 변수 정보들이 들어있는 메모리 영역. 프로그램이 실행되기 위해 항상 존재해야 하는 내용들이 저장된다. 보통 exe파일 안에 들어있는 내용이 이 영역에 들어간다. 여기서 파일에 있는 것을 읽어서 메모리 영역에 Write하는 것을 Loading이라고 한다.

  참고 _ <a href=" https://whereisusb.tistory.com/10 ">프로세스의 주소공간</a>

- **Heap & Stack**

  **Stack 영역에는 지역변수와 매개변수가 저장된다.** 즉, 프로그램의 실행과정에서 '임시로 할당'되고, 끝나면 바로 소멸되는 데이터들이 저장된다. 정확히 말하면, Heap 영역에 생성된 Object 타입의 데이터의 참조값이 할당된다. 그리고 Primitive 타입의 경우 갑과 함께 데이터가 할당된다.

  **Heap 영역에는 코드에서 'new' 명령을 통해 생성된 인스턴스 변수가 할당된다.** 스택 영역에 저장되는 로컬변수, 매개변수와 달리 힙 영역에 보관되는 메모리는 메소드 호출이 끝나도 사라지지 않고 GC가 지우거나 JVM이 종료될 때 까지 유지된다.

  참고 _ <a href=" https://yaboong.github.io/java/2018/05/26/java-memory-management/ ">Java에서 Stack과 Heap</a>

### Dynamic Loading

그럼 Dynamic Loading이 그냥 Loading과의 차이점은 쉽게 말해 **루틴이 호출될 때 까지 메모리에 적재되지 않는다**는 것이다.

- 장점
  1. 일부 클래스가 변경되어도 전체 어플리케이션을 다시 컴파일하지 않아도 된다.
  2. 변경사항이 발생해도 비교적 적은 작업만으로도 처리할 수 있는 유연한 어플리케이션을 작성할 수 있다.
  3. C언어와 다르게 코드 블럭이 여러 곳으로 분산되어 위치해도 된다.
  4. 다형성과 같은 객체지향 개념이 적용가능해진다.
- 단점
  1. 실행 시 연결된 부분에 대한 판단을 해야하므로 속도 측면에서는 불리하다.